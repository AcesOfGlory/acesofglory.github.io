---
layout: minimal
published: true
---

<center>
  <h1>Fifteen Puzzle</h1>
</center>

<style type="text/css">

table {
   border-collapse: collapse;
}
colgroup, tbody {
  border: solid medium;
}
td {
  border: solid thin;
  text-align: center; padding: 0;
  width: 90px;
  height: 90px;
  font-size: 22px;
}

#draggable {
  width: 18%;
  height: 10%;
  position: absolute;
  left: 2%;
  top: 5%;
}

</style>

<head>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
  $( function() {
    $( "#draggable" ).draggable();
  } );
  </script>
</head>

<div id="draggable" class="ui-widget-content">
  <fieldset><legend>Puzzle Options</legend>
    <p>
      Size:
      <input id="boxHeight" type="number" min="10" max="150" value="90" style="width:45;"> x
      <input id="boxWidth" type="number" min="10" max="150" value="90" style="width:45;">
    </p>
    <p>
      Grid Size: (NxN)
      <input id="inputHeight" type="number" min="1" max="100" value="4" style="width:35;"> x
      <input id="inputWidth" type="number" min="1" max="100" value="4" style="width:35;">
    </p>

    <div id="moves-output">Moves: 0</div><br>

    <button type="button" onclick="generateBoard()">Generate</button>
  </fieldset>
</div>

<center>
  <div id="puzzleBoardDiv">
    <table id="puzzleBoardTable">
       <tr> <td id="0x0"> <td id="0x1"> <td id="0x2"> <td id="0x3">
       <tr> <td id="1x0"> <td id="1x1"> <td id="1x2"> <td id="1x3">
       <tr> <td id="2x0"> <td id="2x1"> <td id="2x2"> <td id="2x3">
       <tr> <td id="3x0"> <td id="3x1"> <td id="3x2"> <td id="3x3">
    </table>
  </div>
</center>

<script type="text/javascript">

var moves = 0,
    height = 4, width = 4,
    currentObj,
    puzzle;

const SIZE_MAX = 150,
      SIZE_MIN = 10,
      BOARD_MAX = 100,
      BOARD_MIN = 1;

function generateBoard() {
  if (!sizeCheck()) return false;

  var table = document.getElementById("puzzleBoardDiv");
  table.removeChild(document.getElementById("puzzleBoardTable"));

  var tableCreation = document.createElement("table");
  tableCreation.id = "puzzleBoardTable";

  var tableBody = document.createElement("tbody");

  for (var i = 0; i < height; i++){
    var tr = document.createElement("tr");
    tableBody.appendChild(tr);

    for (var j = 0; j < width; j++){
      var td = document.createElement("td");
      td.id = `${i}x${j}`;
      td.style.height = document.getElementById("boxHeight").value + "px";
      td.style.width = document.getElementById("boxWidth").value + "px";
      tr.appendChild(td);
    }
  }
  tableCreation.appendChild(tableBody);
  table.appendChild(tableCreation);
  generatePuzzle(height, width);
}

function generatePuzzle(height=4, width=4){
  moves = 0;
  document.getElementById("moves-output").innerHTML = `Moves: ${moves}`;
  var length = height * width,
      values = [...Array(length-1)].map((x, y) => y+1).concat(null);

  const shuffleArray = array => {
    for (var i = array.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
    return array;
  }

  shuffleArray(values);
  puzzle = [];

  for (var i = 0; i < height; i++){
    let currentRow = [];
    for (var j = 0; j < width; j++){
      let cur = values.pop();
      let element = document.getElementById(`${i}x${j}`);

      currentRow.push(cur);
      element.innerHTML = cur;

      if (cur === null){
        currentObj = element;
      }

    }
    puzzle.push(currentRow);
  }
  document.documentElement.onkeydown = moveBoard;
}

function moveBoard(e){
  if (!sizeCheck()) return;
  if (e.keyCode)
    var code = e.keyCode;
  else if (e.which)
    var code = e.which;

  var idSplit = currentObj.id.split("x"),
      i = +idSplit[0], j = +idSplit[1];

  if (code == 37 || code == 65){ // Left
    if (j < width-1){
      puzzle[i][j] = puzzle[i][j+1]
      puzzle[i][j+1] = null;
      document.getElementById(`${i}x${j}`).innerHTML = puzzle[i][j];
      currentObj = document.getElementById(`${i}x${++j}`);
      moves++;
    }
  }
  else if (code == 39 || code == 68){     // Right
    if (j >= 1){
      puzzle[i][j] = puzzle[i][j-1]
      puzzle[i][j-1] = null;
      document.getElementById(`${i}x${j}`).innerHTML = puzzle[i][j];
      currentObj = document.getElementById(`${i}x${--j}`);
      moves++;
    }
  }
  else if (code == 38 || code == 87){ // Up
    if (i < height-1){
      puzzle[i][j] = puzzle[i+1][j]
      puzzle[i+1][j] = null;
      document.getElementById(`${i}x${j}`).innerHTML = puzzle[i][j];
      currentObj = document.getElementById(`${++i}x${j}`);
      moves++;
    }
  }
  else if (code == 40 || code == 83){  // Down
    if (i >= 1){
      puzzle[i][j] = puzzle[i-1][j]
      puzzle[i-1][j] = null;
      document.getElementById(`${i}x${j}`).innerHTML = puzzle[i][j];
      currentObj = document.getElementById(`${--i}x${j}`);
      moves++;
    }
  }
  currentObj.innerHTML = puzzle[i][j];
  document.getElementById("moves-output").innerHTML = `Moves: ${moves}`;
}

function sizeCheck(){
  height = +document.getElementById("inputHeight").value;
  width = +document.getElementById("inputWidth").value;
  return height >= BOARD_MIN && height <= BOARD_MAX
          && width >= BOARD_MIN && width <= BOARD_MAX;
}

document.getElementById("inputHeight").addEventListener("input", () => {
  if (sizeCheck)
    generateBoard();
}, false);

document.getElementById("inputWidth").addEventListener("input", () => {
  if (sizeCheck)
    generateBoard();
}, false);


document.getElementById("boxHeight").addEventListener("input", () => {
  const elementHeight = +document.getElementById("boxHeight").value;
  if (elementHeight < SIZE_MIN || elementHeight > SIZE_MAX) return false;
  var changeDimensions = document.getElementsByTagName("td");

  for (var i = 0; i < changeDimensions.length; i++)
    changeDimensions[i].style.height = elementHeight + "px";
}, false);

document.getElementById("boxWidth").addEventListener("input", () => {
  const elementWidth = +document.getElementById("boxWidth").value;
  var changeDimensions = document.getElementsByTagName("td");
  if (elementWidth < SIZE_MIN || elementWidth > SIZE_MAX) return false;

  for (var i = 0; i < changeDimensions.length; i++)
    changeDimensions[i].style.width = elementWidth + "px";
}, false);

generatePuzzle(height, width);

</script>
